<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:sec="http://www.springframework.org/security/facelets/tags">


<!-- Include all compiled plugins (below), or include individual files as needed -->
<ui:composition template="/templates/template.xhtml">
    <ui:define name="subheader">
        <h:outputText class="BigTopic" value="#{msgs['formEprofesionalModificar']}"
                      rendered="#{eprofesionalBean.entity.id!= null}"/>
        <h:outputText class="BigTopic" value="#{msgs['formEprofesionalCrear']}"
                      rendered="#{eprofesionalBean.entity.id == null}"/>
    </ui:define>
    <f:metadata>
        <f:viewParam name="id" value="#{eprofesionalBean.id}"/>
        <f:viewParam name="registro" value="#{eprofesionalBean.parametro}"/>
        <f:event type="preRenderView" listener="#{eprofesionalBean.inicio()}"/>
    </f:metadata>
    <ui:define name="actions">
        <a href="search.jsf"
           class="BoldGray Fs20 FontRobotoLight Fright MarRight20 HoverEffect"><i
                class="icon-list"></i> #{msgs['listar']}</a>
        <h:panelGroup rendered="#{eprofesionalBean.entity.id != null}" id="hello">

            <sec:ifAnyGranted roles="ROLE_AGR">
                <a href="create.jsf"
                   class="BoldGray Fs20 FontRobotoLight Fright MarRight20 HoverEffect"><i
                        class="icon-person_add"></i> #{msgs['btnNuevoEncomienda']}</a>
            </sec:ifAnyGranted>
        </h:panelGroup>
    </ui:define>
    <ui:define name="content">
        <div class="Container90">
            <div class="ContainerIndent">
                <div class="Card  ShadowEffect ui-fluid">
                    <div class="MarAuto WidAutoOnMobile">
                        <div class="ContainerIndent">
                            <div class="EmptyBox20"></div>

                            <ui:include src="createComitente.xhtml"/>

                            <h:form id="crear">
                                <p:panel id="panelCrear">
                                    <p:messages globalOnly="true" styleClass="error"
                                                showSummary="true" showDetail="true"/>
                                    <p:panelGrid columns="2"
                                                 columnClasses="ui-grid-col-4,ui-grid-col-3"
                                                 layout="grid"
                                                 styleClass="ui-panelgrid-blank">
                                        <h:outputText value="#{msgs['form.descripcion']}:" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formFecha']}:" styleClass="FontBold"/>
                                        <h:panelGroup>
                                            <p:inputText id="descripcion" required="true"
                                                         requiredMessage="#{msgs['validationRequired']}"
                                                         value="#{eprofesionalBean.entity.nombre}"/>
                                            <p:message for="descripcion"/>
                                        </h:panelGroup>
                                        <h:panelGroup>
                                            <p:calendar id="fecha" required="true" pattern="dd-MM-yyyy"
                                                        requiredMessage="#{msgs['validationRequired']}"
                                                        value="#{eprofesionalBean.entity.fecha}"
                                                        locale="es"/>
                                            <p:message for="fecha"/>
                                        </h:panelGroup>
                                    </p:panelGrid>
                                    <h:outputText value="#{msgs['formNomenclatura']}" styleClass="FontBold MarLeft10"/>
                                    <p:panelGrid columns="6"
                                                 columnClasses="ui-grid-col-1,ui-grid-col-1,ui-grid-col-1,ui-grid-col-1,ui-grid-col-1,ui-grid-col-1"
                                                 layout="grid"
                                                 styleClass="ui-panelgrid-blank">
                                        <h:outputText value="#{msgs['formDpt']}" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formCirc']}" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formSecc']}" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formUC']}" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formParc']}" styleClass="FontBold"/>
                                        <h:outputText value="#{msgs['formUF']}" styleClass="FontBold"/>
                                        <p:selectOneMenu id="dpt"
                                                         value="#{eprofesionalBean.depto}"
                                                         required="true"
                                                         requiredMessage="#{msgs['validationRequired']}">
                                            <f:selectItems value="#{eprofesionalBean.getDeptos()}" var="e"
                                                           itemLabel="#{e}" itemValue="#{e}"/>
                                        </p:selectOneMenu>
                                        <p:selectOneMenu id="circ"
                                                         value="#{eprofesionalBean.circ}"
                                                         required="true"
                                                         requiredMessage="#{msgs['validationRequired']}">
                                            <f:selectItems value="#{eprofesionalBean.getCircs()}" var="c"
                                                           itemLabel="#{c}" itemValue="#{c}"/>
                                        </p:selectOneMenu>
                                        <p:selectOneMenu id="secc"
                                                         value="#{eprofesionalBean.secc}"
                                                         required="true"
                                                         requiredMessage="#{msgs['validationRequired']}">
                                            <f:selectItems value="#{eprofesionalBean.getSeccs()}" var="s"
                                                           itemLabel="#{s}" itemValue="#{s}"/>
                                        </p:selectOneMenu>
                                        <p:inputText id="uc" required="true"
                                                     requiredMessage="#{msgs['validationRequired']}"
                                                     value="#{eprofesionalBean.uc}"/>
                                        <p:inputText id="parc" required="true"
                                                     requiredMessage="#{msgs['validationRequired']}"
                                                     value="#{eprofesionalBean.parc}"/>
                                        <p:inputText id="uf" required="true"
                                                     requiredMessage="#{msgs['validationRequired']}"
                                                     value="#{eprofesionalBean.uf}"/>
                                    </p:panelGrid>

                                    <div class="EmptyBox30"></div>
                                    <p:fieldset legend="#{msgs['form.comitente']}">
                                        <h:panelGrid styleClass="ui-grid-col-12" columns="2" cellpadding="10"
                                                     columnClasses="ui-grid-col-6,ui-grid-col-3">
                                            <h:outputText value="#{msgs['form.comitente']}:" styleClass="FontBold"
                                                          id="textcomitente"/>
                                            <h:outputText></h:outputText>
                                            <h:panelGroup id="comitentegroup">
                                                <p:selectOneMenu id="comitente" filter="true"
                                                                 value="#{eprofesionalBean.comitenteSelecionada}"
                                                                 converter="#{eprofesionalBean.comitenteConvert}"
                                                                 required="true"
                                                                 requiredMessage="#{msgs['validationRequired']}"
                                                                 rendered="#{!eprofesionalBean.formAltaComitente}">
                                                    <f:selectItem itemLabel="--Seleccione un comitente--"
                                                                  itemValue="-1"/>
                                                    <f:selectItems value="#{eprofesionalBean.listComitente()}" var="e"
                                                                   itemLabel="#{e.nombre}" itemValue="#{e}"/>
                                                </p:selectOneMenu>
                                                <h:outputLabel rendered="#{eprofesionalBean.formAltaComitente}"
                                                               styleClass="FontBold"
                                                >#{eprofesionalBean.comitenteSelecionada.nombre}</h:outputLabel>
                                                <p:message for="comitente"/>
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:commandButton value="#{msgs['btncrearComitente']}"
                                                                 onclick="PF('dlg2').show();"/>
                                            </h:panelGroup>
                                        </h:panelGrid>
                                    </p:fieldset>
                                    <div class="EmptyBox30"></div>
                                    <p:fieldset legend="#{msgs['form.inmueble']}">
                                        <h:panelGrid styleClass="ui-grid-col-12" columns="2"
                                                     columnClasses="ui-grid-col-4,ui-grid-col-4">
                                            <h:outputText value="#{msgs['formTipo']}" styleClass="FontBold"/>
                                            <h:panelGroup></h:panelGroup>
                                            <h:panelGroup>
                                                <p:selectOneMenu id="tipo"
                                                                 value="#{eprofesionalBean.entity.inmueble.tipo}"
                                                                 required="true"
                                                                 requiredMessage="#{msgs['validationRequired']}">
                                                    <f:ajax listener="#{eprofesionalBean.changeInmueble()}"
                                                            event="change" render="inmueble"/>
                                                    <f:selectItems value="#{eprofesionalBean.inmuebleTipos()}"
                                                                   itemLabel="#{t.tipo}" var="t"/>

                                                </p:selectOneMenu>
                                                <p:message for="tipo"/>
                                            </h:panelGroup>
                                            <h:panelGroup></h:panelGroup>
                                            <h:panelGroup id="inmueble">
                                                <h:panelGroup
                                                        rendered="#{eprofesionalBean.mostrarRural(eprofesionalBean.entity.inmueble)}">
                                                    <h:outputText value="#{msgs['form.departamento']}:"
                                                                  styleClass="FontBold"/>
                                                    <h:panelGroup>
                                                        <p:selectOneMenu id="departamentorural" filter="true"
                                                                         widgetVar="departamentorural"
                                                                         value="#{eprofesionalBean.departamentoSelecionado}"
                                                                         converter="departamentoConverter"
                                                                         required="true"
                                                                         requiredMessage="#{msgs['validationRequired']}">
                                                            <f:selectItem itemLabel="--Seleccione un Departamento--"
                                                                          itemValue="-1"/>
                                                            <f:selectItems id="departamentoSeleccionado"
                                                                           value="#{uiSelectOneMenuBean.listDepartamentos}"
                                                                           var="d"
                                                                           itemLabel="#{d.nombre}"
                                                                           itemValue="#{d}"/>
                                                        </p:selectOneMenu>
                                                        <p:message for="departamentorural"/>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                                <h:panelGroup
                                                        rendered="#{eprofesionalBean.mostrarUrbanaSubUrbana(eprofesionalBean.entity.inmueble)}">
                                                    <h:outputText value="#{msgs['form.localidadParaje']}:"
                                                                  styleClass="FontBold"/>
                                                    <h:panelGroup>
                                                        <p:selectOneMenu id="norurallocalidad" filter="true"
                                                                         value="#{eprofesionalBean.ciudadSeleccionada}"
                                                                         converter="ciudadConverter"
                                                                         required="true"
                                                                         requiredMessage="#{msgs['validationRequired']}">
                                                            <f:selectItem itemLabel="Seleccione una Localidad o Paraje"
                                                                          itemValue="-1"/>
                                                            <f:selectItems
                                                                    value="#{uiSelectOneMenuBean.listCiudades}"
                                                                    var="c"
                                                                    itemLabel="#{c.nombre}" itemValue="#{c}"/>
                                                        </p:selectOneMenu>
                                                        <p:message for="norurallocalidad"/>
                                                    </h:panelGroup>
                                                </h:panelGroup>
                                            </h:panelGroup>
                                        </h:panelGrid>
                                    </p:fieldset>
                                    <div class="EmptyBox30"></div>
                                    <p:fieldset legend="#{msgs['tareaProfesional']}">
                                        <h:panelGrid styleClass="ui-grid-col-12" columns="2" cellpadding="10"
                                                     columnClasses="ui-grid-col-6,ui-grid-col-2">
                                            <h:outputText value="#{msgs['form.descripcion']}:" styleClass="FontBold"/>
                                            <h:outputText value="#{msgs['formUnidades']}:" styleClass="FontBold"/>
                                            <h:panelGroup>
                                                <p:selectOneMenu id="tasas" filter="true"
                                                                 value="#{eprofesionalBean.tasaSeleccionada}"
                                                                 converter="#{eprofesionalBean.tasaConvert}"
                                                                 required="true"
                                                                 requiredMessage="#{msgs['validationRequired']}">
                                                    <f:selectItem itemLabel="--Seleccione una tasa--"
                                                                  itemValue="-1"/>
                                                    <f:selectItems value="#{eprofesionalBean.listTasas()}" var="t"
                                                                   itemLabel="#{t.descripcion}"
                                                                   itemValue="#{t}"/>
                                                </p:selectOneMenu>
                                                <p:message for="tasas"/>
                                            </h:panelGroup>
                                            <h:panelGroup>
                                                <p:spinner id="unidades" required="true" min="0"
                                                           requiredMessage="#{msgs['validationRequired']}"
                                                           value="#{eprofesionalBean.entity.tasaUnidades}"/>
                                                <p:message for="unidades"/>
                                            </h:panelGroup>
                                        </h:panelGrid>
                                    </p:fieldset>

                                    <div class="EmptyBox30"></div>
                                    <div class="Fright">
                                        <div class="Wid45 Fleft Responsive45 MarRight10">
                                            <p:commandButton value="#{msgs['btnCancelar']}"
                                                             icon="fa fa-close"
                                                             styleClass="RedButton Fs16 White RaisedButton Fleft FloatNoneOnMobile"
                                                             action="search?faces-redirect=true"
                                                             title="#{msgs['btnCancelar']}" immediate="true"/>
                                        </div>
                                        <div class="Wid45 Fleft Responsive45">
                                            <p:commandButton id="linksave" value="#{msgs['btnGuardar']}"
                                                             icon="fa fa-sign-in"
                                                             styleClass="GreenButton Fs16 White Fright FloatNoneOnMobile"
                                                             action="#{eprofesionalBean.update}" title="Grabar"
                                                             update="panelCrear"/>
                                        </div>
                                    </div>
                                </p:panel>
                            </h:form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            function handleLoginRequest(xhr, status, args) {
                if (args.validationFailed) {
                    PF('dlg2').jq.effect("shake", {times: 5}, 100);
                }
                else {
                    PF('dlg2').hide();
                }
            }
        </script>
    </ui:define>
</ui:composition>

</html>