<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:composition template="/templates/template.xhtml">
    <ui:define name="subheader">
        Reportes
    </ui:define>
    <ui:define name="content">
        <div class="Container100">
            <div class="ContainerIndent">
                <div class="Card ShadowEffect  ">
                    <div class="Container100">
                        <p:tabView orientation="left" id="tabs">
                            <p:tab title="Reporte general">
                                <h:form>
                                    <h:panelGroup layout="block">

                                        <p:selectOneMenu id="aniosgeneral"
                                                         value="#{reportesBean.anioGeneralSelecionado}"
                                                         required="true"
                                                         requiredMessage="#{msgs['validationRequired']}">
                                            <f:selectItem itemLabel="--Seleccione un año--"
                                                          itemValue="" noSelectionOption="true"/>
                                            <f:selectItems value="#{reportesBean.anios}" var="a"
                                                           itemLabel="#{a}" itemValue="#{a}"/>

                                            <p:ajax event="change"
                                                    listener="#{reportesBean.onGeneralChangeAnio()}"
                                                    update="chartgeneral"/>
                                        </p:selectOneMenu>
                                        <p:message for="aniosgeneral" styleClass="alert alert-danger"/>
                                    </h:panelGroup>
                                    <h:panelGroup id="chartgeneral">

                                        <h:panelGroup rendered="#{reportesBean.isrender}">
                                            <p:chart type="bar" model="#{reportesBean.generalBarModel}"
                                                     style="height:300px"/>
                                        </h:panelGroup>
                                        <h:panelGroup rendered="#{!reportesBean.isrender}">
                                            <p:outputPanel layout="block" deferred="true" style="    margin-left: 10px !important;"
                                                           styleClass="ui-messages ui-widget">
                                                <p:outputPanel layout="block"
                                                               styleClass="ui-messages-info ui-corner-all">
                                                    <p:outputPanel layout="inline"
                                                                   styleClass="ui-messages-info-icon"></p:outputPanel>
                                                    <ul>
                                                        <li><span class="ui-messages-warn-summary">Importante</span>
                                                            <span class="ui-messages-warn-detail">No existen reportes para el año seleccionado </span></li>
                                                    </ul>
                                                </p:outputPanel>
                                            </p:outputPanel>
                                        </h:panelGroup>
                                    </h:panelGroup>

                                </h:form>

                            </p:tab>
                            <p:tab title="Proyecciones">
                                <h:form>
                                    <h:panelGroup layout="block">

                                        <p:selectOneMenu id="anios"
                                                         value="#{reportesBean.anioSelecionado}"
                                                         required="true"
                                                         requiredMessage="#{msgs['validationRequired']}">
                                            <f:selectItem itemLabel="--Seleccione un año--"
                                                          itemValue="" noSelectionOption="true"/>
                                            <f:selectItems value="#{reportesBean.aniosAdeudados}" var="p"
                                                           itemLabel="#{p}" itemValue="#{p}"/>

                                            <p:ajax event="change"
                                                    listener="#{reportesBean.onProyeccionesChangeAnio()}"
                                                    update="chartproyecciones"/>
                                        </p:selectOneMenu>
                                        <p:message for="anios" styleClass="alert alert-danger"/>
                                    </h:panelGroup>
                                    <p:chart id="chartproyecciones" type="bar" model="#{reportesBean.barModel}"
                                             style="height:300px"/>
                                </h:form>

                            </p:tab>
                        </p:tabView>


                    </div>
                </div>
            </div>
        </div>

        <script type="text/javascript">
            function handleLoginRequest(xhr, status, args) {
                if (args.validationFailed) {
                    PF('dlg').jq.effect("shake", {times: 5}, 100);
                }
                else {
                    PF('dlg').hide();
                    $('#loginLink').fadeOut();
                }
            }

            function handleLoginRequest2(xhr, status, args) {
                if (args.validationFailed) {
                    PF('dlgCrear').jq.effect("shake", {times: 5}, 100);
                }
                else {
                    PF('dlgCrear').hide();
                    $('#loginLink').fadeOut();
                }
            }

            function handleLoginRequestD(xhr, status, args) {
                if (args.validationFailed) {
                    PF('dlgDescuento').jq.effect("shake", {times: 5}, 100);
                }
                else {
                    PF('dlgDescuento').hide();
                    $('#loginLink').fadeOut();
                }
            }

            function handleLoginRequestD2(xhr, status, args) {
                if (args.validationFailed) {
                    PF('dlgCrearDescuento').jq.effect("shake", {times: 5}, 100);
                }
                else {
                    PF('dlgCrearDescuento').hide();
                    $('#loginLink').fadeOut();
                }
            }
        </script>
    </ui:define>
</ui:composition>
</html>
